{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { MongoClient } from 'mongodb';\nimport nextConnect from 'next-connect';\nvar client = new MongoClient('mongodb://127.0.0.1:27017', {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\n\nfunction database(_x, _x2, _x3) {\n  return _database.apply(this, arguments);\n}\n\nfunction _database() {\n  _database = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(req, res, next) {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (client.isConnected()) {\n              _context.next = 3;\n              break;\n            }\n\n            _context.next = 3;\n            return client.connect();\n\n          case 3:\n            req.dbClient = client;\n            req.db = client.db('nextCart');\n            return _context.abrupt(\"return\", next());\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _database.apply(this, arguments);\n}\n\nvar middleware = nextConnect();\nmiddleware.use(database);\nexport default middleware;","map":{"version":3,"sources":["/home/paramjeet/Desktop/nextcart/middleware/database.js"],"names":["MongoClient","nextConnect","client","useNewUrlParser","useUnifiedTopology","database","req","res","next","isConnected","connect","dbClient","db","middleware","use"],"mappings":";;AAAA,SAASA,WAAT,QAA4B,SAA5B;AACA,OAAOC,WAAP,MAAwB,cAAxB;AAEA,IAAMC,MAAM,GAAG,IAAIF,WAAJ,CAAgB,2BAAhB,EAA6C;AACxDG,EAAAA,eAAe,EAAE,IADuC;AAExDC,EAAAA,kBAAkB,EAAE;AAFoC,CAA7C,CAAf;;SAKeC,Q;;;;;uEAAf,iBAAwBC,GAAxB,EAA6BC,GAA7B,EAAkCC,IAAlC;AAAA;AAAA;AAAA;AAAA;AAAA,gBACSN,MAAM,CAACO,WAAP,EADT;AAAA;AAAA;AAAA;;AAAA;AAAA,mBACqCP,MAAM,CAACQ,OAAP,EADrC;;AAAA;AAEIJ,YAAAA,GAAG,CAACK,QAAJ,GAAeT,MAAf;AACAI,YAAAA,GAAG,CAACM,EAAJ,GAASV,MAAM,CAACU,EAAP,CAAU,UAAV,CAAT;AAHJ,6CAIWJ,IAAI,EAJf;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAOA,IAAMK,UAAU,GAAGZ,WAAW,EAA9B;AAEAY,UAAU,CAACC,GAAX,CAAeT,QAAf;AAEA,eAAeQ,UAAf","sourcesContent":["import { MongoClient } from 'mongodb';\nimport nextConnect from 'next-connect';\n\nconst client = new MongoClient('mongodb://127.0.0.1:27017', {\n    useNewUrlParser: true,\n    useUnifiedTopology: true,\n});\n\nasync function database(req, res, next) {\n    if (!client.isConnected()) await client.connect();\n    req.dbClient = client;\n    req.db = client.db('nextCart');\n    return next();\n}\n\nconst middleware = nextConnect();\n\nmiddleware.use(database);\n\nexport default middleware;"]},"metadata":{},"sourceType":"module"}